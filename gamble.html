<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gamble</title>
    <link rel="icon" type="image/png" href="https://i.imgur.com/iYWxeyS.png">	    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            color: white;
            min-height: 100vh;
            padding: 15px;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: rgba(0, 0, 0, 0.7);
            border-radius: 15px;
            padding: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }
        
        header {
            text-align: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #fdbb2d;
        }
        
        h1 {
            font-size: 2.2rem;
            margin-bottom: 8px;
            color: #fdbb2d;
            text-shadow: 0 2px 5px rgba(0, 0, 0, 0.5);
        }
        
        .game-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            background-color: rgba(0, 0, 0, 0.5);
            padding: 12px;
            border-radius: 10px;
            margin-bottom: 15px;
        }
        
        .stat-box {
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.6rem;
            font-weight: bold;
            color: #fdbb2d;
        }
        
        .game-area {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .games-tab {
            background-color: rgba(0, 0, 0, 0.5);
            border-radius: 10px;
            padding: 12px;
        }
        
        .games-list {
            list-style-type: none;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .game-item {
            padding: 10px 15px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            flex: 1;
            min-width: 140px;
            text-align: center;
        }
        
        .game-item:hover {
            background-color: rgba(253, 187, 45, 0.3);
        }
        
        .game-item.active {
            background-color: rgba(253, 187, 45, 0.7);
            color: black;
            font-weight: bold;
        }
        
        .game-item.locked {
            background-color: rgba(100, 100, 100, 0.5);
            color: #aaa;
            cursor: not-allowed;
            position: relative;
        }
        
        .game-item.locked::after {
            content: "🔒";
            position: absolute;
            top: 5px;
            right: 5px;
            font-size: 0.8rem;
        }
        
        .game-display {
            background-color: rgba(0, 0, 0, 0.5);
            border-radius: 10px;
            padding: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .game-title {
            font-size: 1.6rem;
            margin-bottom: 15px;
            color: #fdbb2d;
        }
        
        .slot-machine {
            width: 100%;
            max-width: 500px;
            background: linear-gradient(145deg, #2c3e50, #1c2833);
            border-radius: 15px;
            padding: 15px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.5);
            margin-bottom: 15px;
        }
        
        .slots {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            gap: 10px;
        }
        
        .slot {
            width: 80px;
            height: 80px;
            background-color: #fff;
            border-radius: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2.5rem;
            color: #333;
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.5);
        }
        
        .large-slots {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            gap: 8px;
        }
        
        .large-slot {
            width: 70px;
            height: 70px;
            background-color: #fff;
            border-radius: 8px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2rem;
            color: #333;
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.5);
        }
        
        .magical-slots {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            gap: 6px;
        }
        
        .magical-slot {
            width: 65px;
            height: 65px;
            background-color: #fff;
            border-radius: 8px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.8rem;
            color: #333;
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.5);
        }
        
        .coin-flip-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .coin-area {
            position: relative;
            width: 150px;
            height: 150px;
            perspective: 1000px;
            margin-bottom: 20px;
        }
        
        .coin {
            width: 150px;
            height: 150px;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 1.5s ease-in-out;
        }
        
        .coin.flipping {
            animation: coinFlip 1.5s ease-in-out;
        }
        
        .coin-face {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            backface-visibility: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.8rem;
            font-weight: bold;
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.3);
        }
        
        .coin-front {
            background: linear-gradient(145deg, #d4af37, #ffd700);
            color: #8b6914;
        }
        
        .coin-back {
            background: linear-gradient(145deg, #c0c0c0, #e8e8e8);
            color: #333;
            transform: rotateY(180deg);
        }
        
        @keyframes coinFlip {
            0% { transform: rotateY(0); }
            50% { transform: rotateY(1800deg); }
            100% { transform: rotateY(3600deg); }
        }
        
        .slot-controls {
            display: flex;
            flex-direction: column;
            gap: 12px;
            width: 100%;
        }
        
        .bet-input {
            display: flex;
            align-items: center;
            gap: 8px;
            justify-content: center;
        }
        
        input[type="number"] {
            padding: 8px;
            border-radius: 5px;
            border: none;
            width: 100px;
            font-size: 1rem;
        }
        
        button {
            padding: 10px 15px;
            background: linear-gradient(145deg, #fdbb2d, #b21f1f);
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 8px rgba(0, 0, 0, 0.4);
        }
        
        button:active {
            transform: translateY(1px);
        }
        
        button:disabled {
            background: #666;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .game-message {
            margin-top: 15px;
            padding: 12px;
            border-radius: 8px;
            text-align: center;
            font-weight: bold;
            min-height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
        }
        
        .win {
            background-color: rgba(46, 204, 113, 0.3);
            color: #2ecc71;
        }
        
        .lose {
            background-color: rgba(231, 76, 60, 0.3);
            color: #e74c3c;
        }
        
        .info {
            background-color: rgba(52, 152, 219, 0.3);
            color: #3498db;
        }
        
        .round-info {
            margin-top: 15px;
            background-color: rgba(0, 0, 0, 0.5);
            padding: 12px;
            border-radius: 10px;
            width: 100%;
        }
        
        .round-progress {
            height: 8px;
            background-color: #333;
            border-radius: 5px;
            margin-top: 8px;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #fdbb2d, #b21f1f);
            width: 0%;
            transition: width 0.5s;
        }
        
        @media (min-width: 768px) {
            .game-stats {
                grid-template-columns: repeat(4, 1fr);
            }
            
            .game-area {
                flex-direction: row;
            }
            
            .games-tab {
                flex: 1;
                min-width: 200px;
            }
            
            .games-list {
                flex-direction: column;
            }
            
            .game-display {
                flex: 3;
            }
            
            .slot {
                width: 90px;
                height: 90px;
            }
            
            .large-slot {
                width: 80px;
                height: 80px;
            }
            
            .magical-slot {
                width: 70px;
                height: 70px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Gamble</h1>
            <p>Reach $1,000,000 after 30 rounds to win!</p>
        </header>
        
        <div class="game-stats">
            <div class="stat-box">
                <div class="stat-label">Current Money</div>
                <div class="stat-value" id="money">$100</div>
            </div>
            <div class="stat-box">
                <div class="stat-label">Current Round</div>
                <div class="stat-value" id="round">1</div>
            </div>
            <div class="stat-box">
                <div class="stat-label">Round Goal</div>
                <div class="stat-value" id="goal">$50</div>
            </div>
            <div class="stat-box">
                <div class="stat-label">Gambled This Round</div>
                <div class="stat-value" id="gambled">$0</div>
            </div>
        </div>
        
        <div class="game-area">
            <div class="games-tab">
                <h2>Games</h2>
                <ul class="games-list">
                    <li class="game-item active" data-game="slot">Small Slot Machine</li>
                    <li class="game-item locked" data-game="large-slot">Large Slot Machine</li>
                    <li class="game-item locked" data-game="coin-flip">Coin Flip</li>
                    <li class="game-item locked" data-game="magical-slot">Magical Slot Machine</li>
                </ul>
            </div>
            
            <div class="game-display">
                <h2 class="game-title">Small Slot Machine</h2>
                
                <!-- Small Slot Machine -->
                <div class="slot-machine" id="small-slot-machine">
                    <div class="slots">
                        <div class="slot" id="slot1">🍒</div>
                        <div class="slot" id="slot2">7</div>
                        <div class="slot" id="slot3">💎</div>
                    </div>
                    
                    <div class="slot-controls">
                        <div class="bet-input">
                            <label for="betAmount">Bet Amount:</label>
                            <input type="number" id="betAmount" min="1" value="10">
                        </div>
                        <button id="spinButton">SPIN</button>
                    </div>
                </div>
                
                <!-- Large Slot Machine -->
                <div class="slot-machine" id="large-slot-machine" style="display: none;">
                    <div class="large-slots">
                        <div class="large-slot" id="large-slot1">🍒</div>
                        <div class="large-slot" id="large-slot2">7</div>
                        <div class="large-slot" id="large-slot3">💎</div>
                        <div class="large-slot" id="large-slot4">🍀</div>
                    </div>
                    
                    <div class="slot-controls">
                        <div class="bet-input">
                            <label for="largeBetAmount">Bet Amount:</label>
                            <input type="number" id="largeBetAmount" min="1" value="10">
                        </div>
                        <button id="largeSpinButton">SPIN</button>
                    </div>
                </div>
                
                <!-- Coin Flip Game -->
                <div class="slot-machine" id="coin-flip-game" style="display: none;">
                    <div class="coin-flip-container">
                        <div class="coin-area">
                            <div class="coin" id="coin">
                                <div class="coin-face coin-front">HEADS</div>
                                <div class="coin-face coin-back">TAILS</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="slot-controls">
                        <div class="bet-input">
                            <label for="coinBetAmount">Bet Amount:</label>
                            <input type="number" id="coinBetAmount" min="1" value="10">
                        </div>
                        <button id="flipButton">FLIP COIN</button>
                    </div>
                </div>
                
                <!-- Magical Slot Machine -->
                <div class="slot-machine" id="magical-slot-machine" style="display: none;">
                    <div class="magical-slots">
                        <div class="magical-slot" id="magical-slot1">🍒</div>
                        <div class="magical-slot" id="magical-slot2">7</div>
                        <div class="magical-slot" id="magical-slot3">💎</div>
                        <div class="magical-slot" id="magical-slot4">🍀</div>
                    </div>
                    
                    <div class="slot-controls">
                        <div class="bet-input">
                            <label for="magicalBetAmount">Bet Amount:</label>
                            <input type="number" id="magicalBetAmount" min="1" value="10">
                        </div>
                        <button id="magicalSpinButton">SPIN</button>
                    </div>
                </div>
                
                <div class="game-message info" id="gameMessage">
                    Welcome! Place your bet and spin the slots.
                </div>
                
                <div class="round-info">
                    <h3>Round Progress</h3>
                    <p>You need to gamble $<span id="roundGoal">50</span> this round. Remaining: $<span id="remaining">50</span></p>
                    <div class="round-progress">
                        <div class="progress-bar" id="progressBar"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Game state
        const gameState = {
            money: 100,
            currentRound: 1,
            gambledThisRound: 0,
            roundGoals: [
                50, 50, 100, 100, 200, 250, 450, 500, 500, 500,
                1000, 1200, 1300, 1500, 2500, 5000, 6000, 10000, 12500, 20000,
                20000, 30000, 50000, 70000, 100000, 130000, 180000, 300000, 550000, 750000
            ],
            smallSymbols: ['🍒', '7', '💎', '⭐'],
            largeSymbols: ['🍒', '7', '💎', '⭐', '🍀'],
            magicalSymbols: ['🍒', '7', '💎', '⭐', '🍀', '🍎', '🪙'],
            jackpotSymbol: '⭐',
            currentGame: 'slot',
            freeSpin: false,
            cheatCode: '',
            unlockedGames: {
                'large-slot': false,
                'coin-flip': false,
                'magical-slot': false
            }
        };

        // DOM elements
        const moneyElement = document.getElementById('money');
        const roundElement = document.getElementById('round');
        const goalElement = document.getElementById('goal');
        const gambledElement = document.getElementById('gambled');
        const roundGoalElement = document.getElementById('roundGoal');
        const remainingElement = document.getElementById('remaining');
        const progressBar = document.getElementById('progressBar');
        const betAmountInput = document.getElementById('betAmount');
        const largeBetAmountInput = document.getElementById('largeBetAmount');
        const coinBetAmountInput = document.getElementById('coinBetAmount');
        const magicalBetAmountInput = document.getElementById('magicalBetAmount');
        const spinButton = document.getElementById('spinButton');
        const largeSpinButton = document.getElementById('largeSpinButton');
        const flipButton = document.getElementById('flipButton');
        const magicalSpinButton = document.getElementById('magicalSpinButton');
        const gameMessage = document.getElementById('gameMessage');
        const slot1 = document.getElementById('slot1');
        const slot2 = document.getElementById('slot2');
        const slot3 = document.getElementById('slot3');
        const largeSlot1 = document.getElementById('large-slot1');
        const largeSlot2 = document.getElementById('large-slot2');
        const largeSlot3 = document.getElementById('large-slot3');
        const largeSlot4 = document.getElementById('large-slot4');
        const magicalSlot1 = document.getElementById('magical-slot1');
        const magicalSlot2 = document.getElementById('magical-slot2');
        const magicalSlot3 = document.getElementById('magical-slot3');
        const magicalSlot4 = document.getElementById('magical-slot4');
        const coin = document.getElementById('coin');
        const smallSlotMachine = document.getElementById('small-slot-machine');
        const largeSlotMachine = document.getElementById('large-slot-machine');
        const coinFlipGame = document.getElementById('coin-flip-game');
        const magicalSlotMachine = document.getElementById('magical-slot-machine');
        const gameItems = document.querySelectorAll('.game-item');

        // Initialize the game
        function initGame() {
            updateUI();
            
            // Set max bet to current money or remaining round goal
            updateBetLimits();
            
            // Add event listeners
            spinButton.addEventListener('click', () => spinSlots('small'));
            largeSpinButton.addEventListener('click', () => spinSlots('large'));
            flipButton.addEventListener('click', flipCoin);
            magicalSpinButton.addEventListener('click', () => spinSlots('magical'));
            
            betAmountInput.addEventListener('input', validateBetAmount);
            largeBetAmountInput.addEventListener('input', validateLargeBetAmount);
            coinBetAmountInput.addEventListener('input', validateCoinBetAmount);
            magicalBetAmountInput.addEventListener('input', validateMagicalBetAmount);
            
            // Game tab switching
            gameItems.forEach(item => {
                item.addEventListener('click', () => {
                    if (!item.classList.contains('active') && !item.classList.contains('locked')) {
                        gameItems.forEach(i => i.classList.remove('active'));
                        item.classList.add('active');
                        switchGame(item.dataset.game);
                    }
                });
            });
            
            // Cheat code listener
            document.addEventListener('keydown', (e) => {
                // Check for cheat code "Trengerpenger"
                gameState.cheatCode += e.key.toLowerCase();
                
                // Reset if code is too long or wrong character
                if (gameState.cheatCode.length > 13 || !'trengerpenger'.startsWith(gameState.cheatCode)) {
                    gameState.cheatCode = '';
                }
                
                // Check if code is complete
                if (gameState.cheatCode === 'trengerpenger') {
                    gameState.money += 2000000;
                    updateUI();
                    gameMessage.textContent = "Cheat activated! You received $2,000,000!";
                    gameMessage.className = 'game-message win';
                    gameState.cheatCode = ''; // Reset after activation
                }
            });
            
            // Check for unlocked games
            checkUnlockedGames();
        }

        // Check which games should be unlocked
        function checkUnlockedGames() {
            // Unlock games based on current round
            if (gameState.currentRound >= 5) {
                gameState.unlockedGames['large-slot'] = true;
                document.querySelector('[data-game="large-slot"]').classList.remove('locked');
            }
            
            if (gameState.currentRound >= 10) {
                gameState.unlockedGames['coin-flip'] = true;
                document.querySelector('[data-game="coin-flip"]').classList.remove('locked');
            }
            
            if (gameState.currentRound >= 15) {
                gameState.unlockedGames['magical-slot'] = true;
                document.querySelector('[data-game="magical-slot"]').classList.remove('locked');
            }
        }

        // Switch between games
        function switchGame(game) {
            gameState.currentGame = game;
            
            // Hide all games
            smallSlotMachine.style.display = 'none';
            largeSlotMachine.style.display = 'none';
            coinFlipGame.style.display = 'none';
            magicalSlotMachine.style.display = 'none';
            
            // Show selected game
            if (game === 'slot') {
                smallSlotMachine.style.display = 'block';
                document.querySelector('.game-title').textContent = 'Small Slot Machine';
            } else if (game === 'large-slot') {
                largeSlotMachine.style.display = 'block';
                document.querySelector('.game-title').textContent = 'Large Slot Machine';
            } else if (game === 'coin-flip') {
                coinFlipGame.style.display = 'block';
                document.querySelector('.game-title').textContent = 'Coin Flip';
            } else if (game === 'magical-slot') {
                magicalSlotMachine.style.display = 'block';
                document.querySelector('.game-title').textContent = 'Magical Slot Machine';
            }
            
            updateBetLimits();
            gameMessage.textContent = `Switched to ${document.querySelector('.game-title').textContent}`;
            gameMessage.className = 'game-message info';
        }

        // Update bet limits based on current money and round goal
        function updateBetLimits() {
            const currentGoal = gameState.roundGoals[gameState.currentRound - 1];
            const remaining = currentGoal - gameState.gambledThisRound;
            const maxBet = Math.min(gameState.money, remaining);
            
            betAmountInput.max = maxBet;
            largeBetAmountInput.max = maxBet;
            coinBetAmountInput.max = maxBet;
            magicalBetAmountInput.max = maxBet;
            
            // Adjust current bet if it exceeds the new limit
            if (parseInt(betAmountInput.value) > maxBet) {
                betAmountInput.value = maxBet;
            }
            if (parseInt(largeBetAmountInput.value) > maxBet) {
                largeBetAmountInput.value = maxBet;
            }
            if (parseInt(coinBetAmountInput.value) > maxBet) {
                coinBetAmountInput.value = maxBet;
            }
            if (parseInt(magicalBetAmountInput.value) > maxBet) {
                magicalBetAmountInput.value = maxBet;
            }
        }

        // Validate the bet amount for small slots
        function validateBetAmount() {
            const betAmount = parseInt(betAmountInput.value);
            const currentGoal = gameState.roundGoals[gameState.currentRound - 1];
            const remaining = currentGoal - gameState.gambledThisRound;
            const maxBet = Math.min(gameState.money, remaining);
            
            if (isNaN(betAmount) || betAmount < 1) {
                betAmountInput.value = 1;
            } else if (betAmount > maxBet) {
                betAmountInput.value = maxBet;
            }
        }

        // Validate the bet amount for large slots
        function validateLargeBetAmount() {
            const betAmount = parseInt(largeBetAmountInput.value);
            const currentGoal = gameState.roundGoals[gameState.currentRound - 1];
            const remaining = currentGoal - gameState.gambledThisRound;
            const maxBet = Math.min(gameState.money, remaining);
            
            if (isNaN(betAmount) || betAmount < 1) {
                largeBetAmountInput.value = 1;
            } else if (betAmount > maxBet) {
                largeBetAmountInput.value = maxBet;
            }
        }

        // Validate the bet amount for coin flip
        function validateCoinBetAmount() {
            const betAmount = parseInt(coinBetAmountInput.value);
            const currentGoal = gameState.roundGoals[gameState.currentRound - 1];
            const remaining = currentGoal - gameState.gambledThisRound;
            const maxBet = Math.min(gameState.money, remaining);
            
            if (isNaN(betAmount) || betAmount < 1) {
                coinBetAmountInput.value = 1;
            } else if (betAmount > maxBet) {
                coinBetAmountInput.value = maxBet;
            }
        }

        // Validate the bet amount for magical slots
        function validateMagicalBetAmount() {
            const betAmount = parseInt(magicalBetAmountInput.value);
            const currentGoal = gameState.roundGoals[gameState.currentRound - 1];
            const remaining = currentGoal - gameState.gambledThisRound;
            const maxBet = Math.min(gameState.money, remaining);
            
            if (isNaN(betAmount) || betAmount < 1) {
                magicalBetAmountInput.value = 1;
            } else if (betAmount > maxBet) {
                magicalBetAmountInput.value = maxBet;
            }
        }

        // Spin the slots
        function spinSlots(slotType) {
            const isSmall = slotType === 'small';
            const isMagical = slotType === 'magical';
            let betAmountInput, spinButton;
            
            if (isSmall) {
                betAmountInput = document.getElementById('betAmount');
                spinButton = document.getElementById('spinButton');
            } else if (isMagical) {
                betAmountInput = document.getElementById('magicalBetAmount');
                spinButton = document.getElementById('magicalSpinButton');
            } else {
                betAmountInput = document.getElementById('largeBetAmount');
                spinButton = document.getElementById('largeSpinButton');
            }
            
            let betAmount = parseInt(betAmountInput.value);
            const currentGoal = gameState.roundGoals[gameState.currentRound - 1];
            const remaining = currentGoal - gameState.gambledThisRound;
            
            // Check if this is a free spin
            if (!gameState.freeSpin) {
                // Validate bet
                if (betAmount > gameState.money) {
                    gameMessage.textContent = "You don't have enough money for that bet!";
                    gameMessage.className = 'game-message lose';
                    return;
                }
                
                if (betAmount > remaining) {
                    gameMessage.textContent = `You can only bet up to $${remaining} this round!`;
                    gameMessage.className = 'game-message lose';
                    return;
                }
                
                if (betAmount < 1) {
                    gameMessage.textContent = "Bet must be at least $1!";
                    gameMessage.className = 'game-message lose';
                    return;
                }
                
                // Deduct bet from money
                gameState.money -= betAmount;
                gameState.gambledThisRound += betAmount;
            } else {
                // Free spin - no bet deduction
                betAmount = 0;
                gameState.freeSpin = false;
            }
            
            // Disable spin button during animation
            spinButton.disabled = true;
            
            // Animate slots
            animateSlots(slotType).then(() => {
                // Determine result
                const result = calculateSlotResult(slotType);
                
                // Update money based on result
                if (result.multiplier > 0) {
                    const winAmount = Math.floor(
    (betAmount || parseInt(magicalBetAmountInput.value)) * result.multiplier
);
                    gameState.money += winAmount;
                    gameMessage.textContent = `You won $${winAmount}! ${result.message}`;
                    gameMessage.className = 'game-message win';
                } else if (result.freeSpin) {
                    gameMessage.textContent = "One gold coin! You get a FREE SPIN!";
                    gameMessage.className = 'game-message win';
                    gameState.freeSpin = true;
                } else {
                    gameMessage.textContent = "No win this time. Try again!";
                    gameMessage.className = 'game-message lose';
                }
                
                // Update UI
                updateUI();
                
                // Check for round completion or game over
                checkGameState();
                
                // Re-enable spin button
                spinButton.disabled = false;
                
                // If free spin, automatically spin again
                if (gameState.freeSpin) {
                    setTimeout(() => {
                        spinSlots('magical');
                    }, 1500);
                }
            });
        }

        // Flip the coin
        function flipCoin() {
            const betAmount = parseInt(coinBetAmountInput.value);
            const currentGoal = gameState.roundGoals[gameState.currentRound - 1];
            const remaining = currentGoal - gameState.gambledThisRound;
            
            // Validate bet
            if (betAmount > gameState.money) {
                gameMessage.textContent = "You don't have enough money for that bet!";
                gameMessage.className = 'game-message lose';
                return;
            }
            
            if (betAmount > remaining) {
                gameMessage.textContent = `You can only bet up to $${remaining} this round!`;
                gameMessage.className = 'game-message lose';
                return;
            }
            
            if (betAmount < 1) {
                gameMessage.textContent = "Bet must be at least $1!";
                gameMessage.className = 'game-message lose';
                return;
            }
            
            // Disable flip button during animation
            flipButton.disabled = true;
            
            // Deduct bet from money
            gameState.money -= betAmount;
            gameState.gambledThisRound += betAmount;
            
            // Animate coin flip
            coin.classList.add('flipping');
            
            setTimeout(() => {
                // Determine result (50/50 chance)
                const isWin = Math.random() > 0.5;
                
                if (isWin) {
                    const winAmount = betAmount * 2;
                    gameState.money += winAmount;
                    gameMessage.textContent = `You won $${winAmount}! Coin landed on HEADS!`;
                    gameMessage.className = 'game-message win';
                } else {
                    gameMessage.textContent = "You lost! Coin landed on TAILS!";
                    gameMessage.className = 'game-message lose';
                }
                
                // Update UI
                updateUI();
                
                // Check for round completion or game over
                checkGameState();
                
                // Re-enable flip button
                flipButton.disabled = false;
                coin.classList.remove('flipping');
            }, 1500);
        }

        // Animate the slot spinning
        function animateSlots(slotType) {
            return new Promise(resolve => {
                const isSmall = slotType === 'small';
                const isMagical = slotType === 'magical';
                const spins = 10; // Number of spins per slot
                let completedSpins = 0;
                const slotCount = isSmall ? 3 : 4;
                const symbols = isSmall ? gameState.smallSymbols : 
                                isMagical ? gameState.magicalSymbols : 
                                gameState.largeSymbols;
                
                function spinSlot(slot, finalSymbol) {
                    let currentSpin = 0;
                    
                    function doSpin() {
                        // Show random symbol during spin
                        const randomIndex = Math.floor(Math.random() * symbols.length);
                        slot.textContent = symbols[randomIndex];
                        
                        currentSpin++;
                        
                        if (currentSpin < spins) {
                            setTimeout(doSpin, 100);
                        } else {
                            // Show final symbol
                            slot.textContent = finalSymbol;
                            completedSpins++;
                            
                            if (completedSpins === slotCount) {
                                // All slots have finished spinning
                                setTimeout(resolve, 500);
                            }
                        }
                    }
                    
                    doSpin();
                }
                
                // Determine final symbols
                const finalSymbols = [];
                for (let i = 0; i < slotCount; i++) {
                    const randomIndex = Math.floor(Math.random() * symbols.length);
                    finalSymbols.push(symbols[randomIndex]);
                }
                
                // Start spinning each slot with a slight delay between them
                if (isSmall) {
                    spinSlot(slot1, finalSymbols[0]);
                    setTimeout(() => spinSlot(slot2, finalSymbols[1]), 200);
                    setTimeout(() => spinSlot(slot3, finalSymbols[2]), 400);
                } else if (isMagical) {
                    spinSlot(magicalSlot1, finalSymbols[0]);
                    setTimeout(() => spinSlot(magicalSlot2, finalSymbols[1]), 150);
                    setTimeout(() => spinSlot(magicalSlot3, finalSymbols[2]), 300);
                    setTimeout(() => spinSlot(magicalSlot4, finalSymbols[3]), 450);
                } else {
                    spinSlot(largeSlot1, finalSymbols[0]);
                    setTimeout(() => spinSlot(largeSlot2, finalSymbols[1]), 150);
                    setTimeout(() => spinSlot(largeSlot3, finalSymbols[2]), 300);
                    setTimeout(() => spinSlot(largeSlot4, finalSymbols[3]), 450);
                }
            });
        }

        // Calculate the slot result
        function calculateSlotResult(slotType) {
            const isSmall = slotType === 'small';
            const isMagical = slotType === 'magical';
            let symbols = [];
            
            if (isSmall) {
                symbols = [
                    slot1.textContent,
                    slot2.textContent,
                    slot3.textContent
                ];
                
                // Check for three of a kind
                if (symbols[0] === symbols[1] && symbols[1] === symbols[2]) {
                    return {
                        multiplier: 25,
                        message: "Three of a kind!"
                    };
                }
                
                // Check for two of a kind
                if (symbols[0] === symbols[1] || symbols[1] === symbols[2] || symbols[0] === symbols[2]) {
                    return {
                        multiplier: 1.5,
                        message: "Two of a kind - small win!"
                    };
                }
            } else if (isMagical) {
                symbols = [
                    magicalSlot1.textContent,
                    magicalSlot2.textContent,
                    magicalSlot3.textContent,
                    magicalSlot4.textContent
                ];
                
                // Count gold coins
                const goldCoinCount = symbols.filter(symbol => symbol === '🪙').length;
                
                // Check for gold coins
                if (goldCoinCount === 1) {
                    return {
                        multiplier: 0,
                        message: "",
                        freeSpin: true
                    };
                } else if (goldCoinCount === 2) {
                    return {
                        multiplier: 15,
                        message: "Two gold coins! 20x return!"
                    };
                } else if (goldCoinCount === 3) {
                    return {
                        multiplier: 200,
                        message: "Three gold coins! 250x return!"
                    };
                } else if (goldCoinCount === 4) {
                    return {
                        multiplier: 1500,
                        message: "FOUR GOLD COINS! JACKPOT! 1500x return!"
                    };
                }
                
                // Check for four of a kind (non-gold coins)
                if (symbols[0] === symbols[1] && symbols[1] === symbols[2] && symbols[2] === symbols[3]) {
                    return {
                        multiplier: 10,
                        message: "All four symbols match!"
                    };
                }
                
                // Check for three of a kind (non-gold coins)
                const counts = {};
                symbols.forEach(symbol => {
                    if (symbol !== '🪙') {
                        counts[symbol] = (counts[symbol] || 0) + 1;
                    }
                });
                
                for (const symbol in counts) {
                    if (counts[symbol] >= 3) {
                        return {
                            multiplier: 2,
                            message: "Three of a kind!"
                        };
                    }
                }
            } else {
                symbols = [
                    largeSlot1.textContent,
                    largeSlot2.textContent,
                    largeSlot3.textContent,
                    largeSlot4.textContent
                ];
                
                // Check for four of a kind
                if (symbols[0] === symbols[1] && symbols[1] === symbols[2] && symbols[2] === symbols[3]) {
                    return {
                        multiplier: 450,
                        message: "JACKPOT! All four symbols match!"
                    };
                }
                
                // Check for three of a kind
                const counts = {};
                symbols.forEach(symbol => {
                    counts[symbol] = (counts[symbol] || 0) + 1;
                });
                
                for (const symbol in counts) {
                    if (counts[symbol] >= 3) {
                        return {
                            multiplier: 10,
                            message: "Three of a kind!"
                        };
                    }
                }
            }
            
            // No win
            return {
                multiplier: 0,
                message: ""
            };
        }

        // Check game state after each spin
        function checkGameState() {
            const currentGoal = gameState.roundGoals[gameState.currentRound - 1];
            
            // Check for unlocked games
            checkUnlockedGames();
            
            // Check if player has gambled enough for this round
            if (gameState.gambledThisRound >= currentGoal) {
                // Move to next round
                gameState.currentRound++;
                gameState.gambledThisRound = 0;
                
                // Check if player has money for next round
                if (gameState.currentRound <= 30) {
                    const nextGoal = gameState.roundGoals[gameState.currentRound - 1];
                    if (gameState.money < nextGoal) {
                        // Game over - not enough money for next round
                        gameMessage.textContent = `Game Over! You don't have enough money for Round ${gameState.currentRound}.`;
                        gameMessage.className = 'game-message lose';
                        spinButton.disabled = true;
                        largeSpinButton.disabled = true;
                        flipButton.disabled = true;
                        magicalSpinButton.disabled = true;
                    } else {
                        // Continue to next round
                        gameMessage.textContent = `Round ${gameState.currentRound} started! You need to gamble $${nextGoal} this round.`;
                        gameMessage.className = 'game-message info';
                    }
                } else {
                    // Check if player won the game
                    if (gameState.money >= 1000000) {
                        gameMessage.textContent = "Congratulations! You've reached $1,000,000 and won the game!";
                        gameMessage.className = 'game-message win';
                    } else {
                        gameMessage.textContent = "Game Over! You completed all rounds but didn't reach $1,000,000.";
                        gameMessage.className = 'game-message lose';
                    }
                    spinButton.disabled = true;
                    largeSpinButton.disabled = true;
                    flipButton.disabled = true;
                    magicalSpinButton.disabled = true;
                }
                
                updateUI();
            }
        }

        // Update the UI with current game state
        function updateUI() {
            moneyElement.textContent = `$${gameState.money}`;
            roundElement.textContent = gameState.currentRound;
            
            const currentGoal = gameState.roundGoals[gameState.currentRound - 1];
            goalElement.textContent = `$${currentGoal}`;
            roundGoalElement.textContent = currentGoal;
            
            const remaining = currentGoal - gameState.gambledThisRound;
            remainingElement.textContent = remaining;
            
            gambledElement.textContent = `$${gameState.gambledThisRound}`;
            
            // Update progress bar
            const progress = (gameState.gambledThisRound / currentGoal) * 100;
            progressBar.style.width = `${Math.min(progress, 100)}%`;
            
            // Update bet limits
            updateBetLimits();
        }

        // Initialize the game when the page loads
        window.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>

